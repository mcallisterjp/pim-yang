<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
    <!ENTITY rfc2119 SYSTEM
      "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
    <!ENTITY rfc3569 SYSTEM
      "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3569.xml">
    <!ENTITY rfc3973 SYSTEM
      "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3973.xml">
    <!ENTITY rfc4601 SYSTEM
      "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4601.xml">
    <!ENTITY rfc4610 SYSTEM
      "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4610.xml">
    <!ENTITY rfc5015 SYSTEM
      "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5015.xml">
    <!ENTITY rfc5059 SYSTEM
      "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5059.xml">
    <!ENTITY rfc6020 SYSTEM
      "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6020.xml">
    <!ENTITY rfc6087 SYSTEM
      "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6087.xml">
    <!ENTITY rfc6241 SYSTEM
      "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6241.xml">
    <!ENTITY I-D.ietf-netmod-rfc6087bis SYSTEM
      "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-netmod-rfc6087bis.xml">
    <!ENTITY I-D.ietf-netmod-routing-cfg SYSTEM
      "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-netmod-routing-cfg.xml">
    <!ENTITY pim-base-tree SYSTEM "ietf-pim-base_tree.txt">
    <!ENTITY pim-base-yang SYSTEM "ietf-pim-base.yang">
    <!ENTITY pim-rp-tree SYSTEM "ietf-pim-rp_tree.txt">
    <!ENTITY pim-rp-yang SYSTEM "ietf-pim-rp.yang">
    <!ENTITY pim-sm-tree SYSTEM "ietf-pim-sm_tree.txt">
    <!ENTITY pim-sm-yang SYSTEM "ietf-pim-sm.yang">
    <!ENTITY pim-dm-tree SYSTEM "ietf-pim-dm_tree.txt">
    <!ENTITY pim-dm-yang SYSTEM "ietf-pim-dm.yang">
    <!ENTITY pim-bidir-tree SYSTEM "ietf-pim-bidir_tree.txt">
    <!ENTITY pim-bidir-yang SYSTEM "ietf-pim-bidir.yang">
]>

<!-- may be omitted for very short documents -->
<?rfc toc="yes"?>
<?rfc sortrefs="no"?>
<?rfc symrefs="yes"?>
<?rfc strict="no"?>
<?rfc rfcedstyle="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>

<!-- these two save paper: start new sections from the same page etc. -->
<?rfc compact="yes"?> <?rfc subcompact="no"?>

<!-- other categories: bcp, exp, historic, std -->
<rfc ipr="trust200902" category="std" docName="draft-mcallister-pim-yang-00">

  <front>

    <title abbrev='PIM YANG'>
      A YANG data model for Protocol-Independent Multicast (PIM)
    </title>

    <author fullname="Liu Xufeng" initials="X." surname="Liu">
      <organization>Ericsson</organization>
      <address>
        <postal>
          <street>1595 Spring Hill Road, Suite 500</street>
          <city>Vienna</city>
          <code>VA 22182</code>
          <country>USA</country>
        </postal>
        <email> xufeng.liu@ericsson.com </email>
      </address>
    </author>

    <author fullname="Pete McAllister" initials="P." surname="McAllister">
      <organization>Metaswitch Networks</organization>
      <address>
        <postal>
          <street>100 Church Street</street>
          <city>Enfield</city>
          <code>EN2 6BQ</code>
          <country>UK</country>
        </postal>
        <email> pete.mcallister@metaswitch.com</email>
      </address>
    </author>

    <author fullname="Anish Peter" initials="A." surname="Peter">
      <organization>Juniper Networks</organization>
      <address>
        <postal>
        <street>Electra, Exora Business Park</street>
        <city>Bangalore</city>
        <region>KA</region>
        <code>560103</code>
        <country>India</country>
        </postal>
        <email>anishp@juniper.net</email>
      </address>
    </author>
    
    <date month='' year="2015"/>
    <area>Routing</area>
    <workgroup>PIM Working Group</workgroup>

    <keyword>Network Management</keyword>
    <keyword>PIM</keyword>
    <keyword>YANG</keyword>

    <abstract>
      <t>
        This document defines a YANG data model that can be used to configure
        Protocol Independent Multicast (PIM) devices.
      </t>
    </abstract>
  </front>

  <middle>

    <section title="Introduction">
      <t>
        YANG <xref target="RFC6020"/> <xref target="RFC6087"/> is a data
        definition language that was introduced to model the configuration
        and running state of a device managed using NETCONF <xref target="RFC6241"/>.
        YANG is now also being used as a component of wider management
        interfaces, such as CLIs.
      </t>
      <t>
        This document defines a draft YANG data model that can be used to
        configure and manage Protocol-Independent Multicast (PIM) devices.
        Currently this model is incomplete, but it will support the core PIM
        protocol, as well as many other features mentioned in separate PIM RFCs.
        Non-core features are defined as optional in the provided data model.
      </t>

      <section title="Requirements Language">
        <t>
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
          "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" and
          "OPTIONAL" in this document are to be interpreted as described in
          BCP 14, RFC 2119 <xref target="RFC2119"/>.
        </t>
      </section>

      <section title="Terminology">
        <t>
          The terminology for describing YANG data models is found in 
          <xref target="RFC6020"/>.
        </t>
        <t>
          This draft employs YANG tree diagrams, which are explained in
          <xref target="I-D.ietf-netmod-rfc6087bis"/>.
        </t>
      </section>
    </section>

    <section title="Design of Data Model">
      <section title="Scope of model">
        <t>
          The model covers PIM Sparse Mode <xref target="RFC4601"/>, including the 
          Source-Specfic subset <xref target="RFC3569"/>, Dense Mode
          <xref target="RFC3973"/>, and Bi-directional PIM <xref target="RFC5015"/>.
        </t>
        <t>
          The PIM extensions represented in the model include BSR
          <xref target="RFC5059"/> and Anycast RP <xref target="RFC4610"/>.
        </t>
        <t>
          The representation of some of these features is not completely specified 
          in this draft of the data model. This model is being circulated in its
          current form for early oversight and review of the basic hierarchy.
        </t>
        <t>
          This model does not cover other multicast protocols such as IGMP/MLD,
          MSDP, mVPN, or m-LDP in-band signalling. It does not cover any configuration
          required to generate the MRIB. These will be covered by future Internet Drafts.
        </t>
      </section>
      <section title="Optional capabilities">
        <t>
          This model is designed to represent the capabilities of PIM devices
          with various specifications, including some with basic subsets of the
          PIM protocol. Since a design goal of this draft is to define a data
          model that is capable of representing all of these implementations,
          these modules declare a number of features representing capabilities
          that not all deployed devices support.
        </t>
        <t>
          The extensive use of feature declarations should substantially
          simplify the capability negotiation process for a vendor's PIM 
          implementation.
        </t>
        <t>
          For the same reason, wide constant ranges (for example, timer maxima
          and minima) will be used in the model. It is expected that vendors will
          augment the model with any specific restrictions that might be 
          required. Vendors may also extend the features list with proprietary
          extensions.
        </t>
      </section>
      <section title="Top-level structure">
        <t>
          This model defines several separate modules for modelling PIM
          configuration, defined below. Again, this separation will make it 
          easier to express the specific capabilities of a PIM device.
        </t>
        <t>
          The hierarchy of PIM configuration is designed so that objects that
          are only relevant for one situation or feature are collected in a
          container for that feature. For example, the configuration for PIM-SM
          that is not relevant for an SSM-only implementation is collected in an
          ASM container.
        </t>
        <t>
          Where fields are not genuinely essential to protocol operation, they
          are marked as optional. Some fields will be essential but have a
          default specified, so they need not be explicitly configured.
        </t>
      </section>
    </section>

    <section title="Unresolved Issues">
      <section title="Current status of work in progress">
        <t>
          The model so far details how the PIM modules interact and covers the
          higher levels of their hierarchy. Some details of interface configuration,
          RP configuration, and PIM-ASM-specific parameters are also complete.
        </t>
        <t>
          For a list of the most substantial areas still to cover, please see the
          "TODO list" section below.
        </t>
      </section>
      <section title="Position of address family in hierarchy">
        <t>
          The current draft (1) has an address-family container at a high level in
          the hierarchy of the model, with an interface list as a child object. This
          is a similar structure to the draft OSPF YANG model. There is ongoing
          discussion about this decision in the design team, so this may be considered
          unresolved.
        </t>
        <t>
          An alternative structure (2) would be for the address family to be a sub-
          list of the interface object. We would then provide interface configuration
          objects at both an address family-specific and a non-AF-specific level, 
          exposing both options as mutually-exclusive features. This would be a similar
          structure to the IS-IS YANG draft.
        </t>
        <t>
          Another option (3) would be to expose both sets of objects, address-family
          specific and all-address-family, both exposed as features. Vendors could 
          then advertise support for one or other of the features. This is the approach
          taken in this draft for entity-scoped parameters like graceful restart
          configuration.
        </t>
        <t>
          The advantages of (1) over (2) are that interface objects effectively
          represent {interface, address-family} pairs, which is in line with several
          existing implementations. Expressing interface-scoped configuration that
          is also address family dependent is made much easier using this model.
        </t>
        <t>
          It also may be useful to be able to configure router-wide options on an 
          address-family basis, which would be more inconvenient if address
          family were a child object of the interface list. At least one deployed
          implementation allows configuration of basic router-scoped concepts on 
          an address family basis.
        </t>
        <t>
          The main disadvantage of (1) compared to (2) is for implementations that
          configure interfaces on an address-family-independent basis with one set
          of configuration. This is true of some existing vendors' implementations,
          as PIM has a single specification for IPv4 and IPv6 address families, and 
          for these implementations the structure (2) is more natural. For some 
          interface parameters there is no clear use-case for address-family-specific
          configuration.
        </t>
        <t>
          For these implementations, the restriction that interface configuration 
          must be address-family independent must be expressed somehow. This can be
          done in various ways; perhaps the easiest is a constraint of a form similar
          to:
        </t>
        <t>
          must “. = ../../address-family[address-family='ipv4']/
            interface[interface=current()/sibling:interface]/dr-priority” {
            error-app-tag dr-priority-mismatch;
            error-message "Error: IPv6 DR priority must match IPv4 DR priority ";
          }
        </t>
        <t>
          Conversely, if (2) were adopted, an implementation that allowed address-
          family-specific configuration would have to make augmentations to the base
          model in order to express that flexibility. Those augmentations would not be
          particularly difficult to make, however.
        </t>  
        <t>
          The advantage of (3) over (1) or (2) is that no such vendor augmentations or 
          constraints would be required. It is likely that vendors' requirements under 
          models (1) or (2) would be similar enough that option (3) would cover all 
          needs in this area.
        </t>
        <t>
          The advantage of (1) or (2) over (3) is just that the model is simpler and 
          leaner, and that feature negotiation is simpler and easier to understand.
        </t>
      </section>
      <section title="RP configuration tree">
        <t>
          This draft of the model provides a module (currently called pim-rp)
          which is used for group range mapping configuration. Though some of 
          this configuration is only relevant for some PIM modes, the pim-rp
          structure itself is independent of the PIM mode structures. 
        </t>
        <t>
          The main advantage of this structure is that it substantially 
          simplifies the representation of the mapping algorithm from a specific
          group address to its PIM mode and configuration. Validation is also 
          easier, as only the pim-rp module itself needs to be checked if there
          is another entry with a conflicting or inconsistent group prefix.
        </t>
        <t>
          There are also some advantages to this approach in non-duplication of
          configuration parameters that are specific to multiple PIM modes, such 
          as BSR.
        </t>
        <t>
          The current name of this module is pim-rp, as it is roughly analogous
          to the pimStaticRPTable in the PIM MIB, and it is currently indexed by
          RP.
        </t>
        <t>
          However, as it is used for some group-range-scoped configuration not
          directly related to RPs, and because a single RP address might need two
          rows in the table (for SM and BI-DIR), it might be better to call this
          something like pim-group-mapping and index it on group range. This is
          still under discussion.
        </t>
      </section>
      <section title="Passive mode">
        <t>
          This draft contains an interface leaf 'passive', indicating that no PIM
          protocol messages are to be sent on the interface.
        </t>
        <t>
          For some implementations, there is a closely related concept, configurable
          on a PIM-mode basis, that an interface is not used to run the PIM protocol
          and also not used for multicast forwarding. This may be used to restrict
          dense-mode flooding, for example. This will likely be included as a feature
          in a future draft, but the details are under discussion.
        </t>
      </section>
    </section>

    <section title="Module Structure">
      <section title="PIM base module">
        <t>
          The PIM base module defines the router-wide configuration options not
          specific to any PIM mode, and is included by the other modules. There
          are a couple of things worth mentioning here regarding where the PIM
          model fits in the overall routing hierarchy:
          <list style='numbers'>
            <t>
              Our current direction is to agree to a routing-instance-centric (VRF)
              model as opposed to protocol-centric mainly because it fits well into
              the routing-instance model, and it is easier to map from the VRF-centric
              to the protocol-centric than the other way around due to forward
              references.
            </t>
            <t>
              The PIM base model will augment "/rt:routing/rt:routing-instance/
              rt:routing-protocols:” as opposed to augmenting "/rt:routing/
              rt:routing-instance/rt:routing-protocols:/rt:routing-protocol” as the
              latter would allow multiple protocol instances per VRF, which does not
              make sense for PIM.
            </t>
          </list>
        </t>
        <figure><artwork>
          &pim-base-tree;
        </artwork></figure>
      </section>
      <section title="PIM RP module">
        <t>
          The PIM RP module contains configuration information scoped to 
          ranges of group addresses. This does not belong in the hierarchy
          under any PIM mode, as it is how group ranges are assigned to PIM
          modes.
        </t>
        <t>
          Some of the content of the module, however, is only relevant to some
          modes (for example, BSR is only relevant to ASM and BIDIR). This is 
          clarified in the module itself using "if-feature" and "when" statements.
        </t>
        <figure><artwork>
          &pim-rp-tree;
        </artwork></figure>
      </section>
      <section title="PIM-SM module">
        <t>
          This module covers Sparse Mode configuration, including PIM-ASM and PIM-SSM.
        </t>
        <figure><artwork>
          &pim-sm-tree;
        </artwork></figure>
      </section>
      <section title="PIM-DM module">
        <t>
          This module will cover Dense Mode configuration.
        </t>
        <figure><artwork>
          &pim-dm-tree;
        </artwork></figure>
      </section>
      <section title="PIM-BIDIR module">
        <t>
          This module will cover Bidirectional PIM configuration.
        </t>
        <figure><artwork>
          &pim-bidir-tree;
        </artwork></figure>
      </section>
    </section>

    <section title="PIM YANG Modules">
      <section title="PIM base module">
        <figure><artwork>
          &pim-base-yang;
        </artwork></figure>
      </section>
      <section title="PIM RP module">
        <figure><artwork>
          &pim-rp-yang;
        </artwork></figure>
      </section>
      <section title="PIM-SM module">
        <figure><artwork>
          &pim-sm-yang;
        </artwork></figure>
      </section>
      <section title="PIM-DM module">
        <figure><artwork>
          &pim-dm-yang;
        </artwork></figure>
      </section>
      <section title="PIM-BIDIR module">
        <figure><artwork>
          &pim-bidir-yang;
        </artwork></figure>
      </section>
    </section>

    <section title="TODO list">
      <t>
        In this draft, several aspects of the model are incomplete. The PIM-DM
        and BI-DIR modules are just placeholders for now to demonstrate the 
        hierarchy of the model. Other things the draft will include when
        complete but does not yet include:
        <list style='symbols'>
          <t>
            State reporting
          </t>
          <t>
            Notifications
          </t>
          <t>
            Neighbor configuration
          </t>
          <t>
            Interaction with BFD protocol
          </t>
          <t>
            Constraints (constant ranges, validation)
          </t>
          <t>
            State-limiting and policy
          </t>
          <t>
            Statistics.
          </t>
        </list>
      </t>
      <t>
        For these subjects, we will employ the same design principles of
        expressing a highly general model; vendors may use features and add
        augmentations in order to express which subsets of this general model
        are valid in their implementations.
      </t>
    </section>

    <section title="Security Considerations">
      <t>
        The data model defined does not introduce any security implications.
      </t>
      <t>
        This draft does not change any underlying security issues inherent in
        <xref target="I-D.ietf-netmod-routing-cfg"/>.
      </t>
    </section>

    <section title="IANA Considerations">
      <t>
        TBD
      </t>
    </section>

    <section title='Acknowledgements'>
      <t>
        The authors would like to thank Steve Baillargeon, Guo Feng, Hu Fangwei,
        Robert Kebler, Tanmoy Kundu, Liu Yisong, Mahesh Sivakumar,
        and Stig Venaas for their valuable contributions.
      </t>
    </section>

  </middle>

  <back>

    <references title="Normative References">
      &rfc2119;
      &rfc6020;
      &rfc6241;
      &I-D.ietf-netmod-rfc6087bis;
    </references>

    <references title="Informative References">
      &rfc3569;
      &rfc3973;
      &rfc4601;
      &rfc4610;
      &rfc5015;
      &rfc5059;
      &rfc6087;
      &I-D.ietf-netmod-routing-cfg;
    </references>

  </back>

</rfc>
